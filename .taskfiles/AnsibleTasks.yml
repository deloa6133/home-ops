---
version: "3"

vars:
  PROJECT_DIR:
    sh: "git rev-parse --show-toplevel"
  ANSIBLE_DIR: "{{.PROJECT_DIR}}/lab/provision/ansible"

tasks:
  install:
    desc: Install Ansible onto the system
    cmds:
      - "apt-get --assume-yes install ansible"
    status:
      - command -v "ansible" &> /dev/null

  init:
    desc: Install/Upgrade Ansible Galaxy dependencies
    dir: "{{.ANSIBLE_DIR}}"
    cmds:
      - "ansible-galaxy install -r requirements.yml --force"
      - "ansible-galaxy collection install -r requirements.yml --force"
